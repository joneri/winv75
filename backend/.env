MODE=development

# server
PORT=3001
MONGO_URI=mongodb://localhost:27017/winv75

# elo seeding (ST points)
ELO_SEED_BASE=10
ELO_SEED_ALPHA=40
ELO_SEED_MIN=1000
ELO_SEED_MAX=1400

# core elo dynamics
ELO_K=12

# class weighting
ELO_CLASS_MIN=0.3
ELO_CLASS_MAX=1.4
ELO_CLASS_REF=35000
ELO_K_CLASS_MULTIPLIER=1.1

# class elo (long horizon)
RATING_DECAY_DAYS=365

# form elo (short horizon)
FORM_RATING_DECAY_DAYS=90

# --- composite ranking (jonas ai) ---
# composite = formElo/AI_RANK_FORM_ELO_DIVISOR + AI_RANK_W_FORM*formScore + bonuses + handicapAdj
AI_RANK_FORM_ELO_DIVISOR=36   # mer tyngd till Form-Elo (var 38/45)
AI_RANK_W_FORM=0.5            # dämpar formScore (var 0.6/1.0)
AI_RANK_ELO_DIVISOR=50        # kvar för ev. alternativ beräkning

# bonusar (nedtonade: ska bryta likvärdiga case, inte styra rank själva)
AI_RANK_BONUS_SHOE=0.35
AI_RANK_BONUS_BARFOTA_RUNTOM=0.45
AI_RANK_BONUS_FAVORITE_SPAR=0.35
AI_RANK_BONUS_TRACK_FAVORITE_SPAR=0.45
AI_RANK_BONUS_FAVORITE_TRACK=0.55

# tillägg/försprång → poäng
AI_RANK_HANDICAP_DIVISOR=40

# --- tiers, sannolikheter och banner ---
AI_RANK_TIER_BY=composite          # tiers i linje med score som driver p_i
AI_TIER_MIN_PROB_FOR_A=0.05        # auto-nergradera A om p < 5 %
AI_TIER_MIN_Z_FOR_A=-0.6           # auto-nergradera A om z < −0.6

# “skydd” så topp-2 i Form-Elo inte hamnar utanför A i jämna fält
AI_TIER_PROTECT_TOPN_BY_FORMELO=2  # skydda topp-2 i Form-Elo
AI_TIER_PROTECT_WITHIN_FORMELO=30  # om inom 30 Form-Elo-poäng från ledaren
AI_TIER_PROTECT_MIN_PROB=0.04      # men bara om p ≥ 4 %
AI_TIER_PROTECT_MIN_Z=-0.8         # och z ≥ −0.8

# sannolikheter (softmax över vald score)
AI_RANK_PROB_SCORE_BASE=composite
AI_RANK_SOFTMAX_BETA=3.0

# banner (spik-indikator)
AI_RANK_SPIK_TOPPROB_MIN=0.50      # topphästen ≥ 50 %
AI_RANK_SPIK_GAP_MIN=0.15          # + minst 15 %-enheters gap till tvåan
AI_GUIDE_SPIK_MIN_GAP=0.15
AI_GUIDE_SPIK_MAX_A_COVERAGE=0.65  # bara för guide-text/nyans

# debug
AI_RANK_DEBUG=false

# raceday ai caching & cron
AI_RACEDAY_CACHE_TTL_MINUTES=120
AI_RACEDAY_CRON=15 6 * * *
AI_RACEDAY_DAYS_AHEAD=3